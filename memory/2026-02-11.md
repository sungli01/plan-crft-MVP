# 2026-02-11 작업 로그

## 작업 시간
- 시작: 09:58 GMT+9 (전날 이어서)
- 주요 작업: 10:50 ~ 11:23 GMT+9
- 소요: 약 1시간 30분

## 주요 작업

### 1번: 프로젝트 삭제 시 사이드바 동기화 ✅

**문제:**
- 프로젝트 삭제 후 좌측 사이드바의 "최근 프로젝트" 목록이 업데이트되지 않음
- 페이지 새로고침해야만 반영됨

**해결:**
- Custom event `projectsChanged` 도입
- 프로젝트 삭제 시 (단일/일괄) event dispatch
- Sidebar가 event를 listen하고 프로젝트 목록 자동 새로고침
- 모든 삭제 위치에서 작동 (projects page, project detail page)

**커밋:** `4b9218c` - fix: sync sidebar project list on delete

---

### 2번: 문서 생성 예상 시간 표시 ✅

**기능:**
- Architect 단계에서 섹션 개수 기반으로 예상 시간 계산
- 공식: `(섹션 개수 × 30초) + 3분 오버헤드`
- Backend API에서 `estimatedMinutes`, `estimatedEndTime`, `remainingMinutes` 반환
- Frontend에 "약 15분 남음" 실시간 표시

**구현:**
- `ProgressTracker.setEstimatedTime()` 추가
- `ProgressTracker.getRemainingTime()` 추가
- Frontend types에 예상 시간 필드 추가
- Progress bar 아래에 남은 시간 표시

**커밋:** `3acecd6` - feat: add estimated completion time display

---

### 3번: ImageCurator 관련성 검증 강화 ✅

**문제:**
- ImageCurator가 섹션 내용과 관련 없는 일반적인 이미지를 삽입
- 장식용 이미지로 문서 가독성 저하

**해결:**
- System prompt에 엄격한 관련성 규칙 추가:
  - 이미지는 **실제 가치**를 제공해야 함 (설명, 데이터 시각화, 프로세스 흐름)
  - 일반적/장식적 이미지 **금지**
  - 의심스러운 경우 `needsImage=false` 반환
  - 사업계획서에는 다이어그램/차트 우선, 사진 지양

**이미지 추가 기준:**
- ✓ 데이터/통계 → 차트
- ✓ 프로세스 설명 → 플로우차트
- ✓ 시스템 구조 → 다이어그램
- ✓ 시장 분석 → 차트/그래프
- ✓ 재무 예측 → 표/차트

**이미지 생략 기준:**
- ✗ 단순 텍스트 설명
- ✗ 요약 (Executive Summary)
- ✗ 법률/정책 섹션
- ✗ 일반 소개
- ✗ 연락처 정보

---

### 4번: 공문서 작성 규칙 적용 ✅

**참고:** https://note4all.tistory.com/entry/최소한의-공문서-작성-규칙

**적용된 규칙:**

#### 1. 항목 표시 방법 (계층적 구조)
```
1. 첫 번째 수준 (한글 숫자)
  가. 두 번째 수준 (괄호 붙은 한글)
    1) 세 번째 수준 (괄호 붙은 숫자)
      a) 네 번째 수준 (괄호 붙은 영문소문자)
```

#### 2. 띄어쓰기
- 하위 항목: 상위에서 2칸 들여쓰기
- 항목 기호와 내용: 1칸 띄우기
- 여러 줄: 내용 첫 글자 위치에 정렬

#### 3. 숫자/날짜/시간 표기
- **날짜:** `2026. 2. 11.` (연/월/일 대신 마침표)
- **시간:** `14:30` (24시간제, 시/분 대신 쌍점)
- **금액:** `금1,500,000원(금일백오십만원)`
- **숫자 1:** 한글로 "일"

#### 4. 내용 작성 원칙
- 간결하고 명확한 문장
- 구체적 수치와 근거 제시
- 전문 용어는 설명 추가
- 불필요한 수식어 지양
- 500-1000자 분량

**Writer Agent System Prompt 전면 개선:**
- 공문서 작성 규칙 상세히 명시
- 예시 포함
- Markdown 형식과 병행

**커밋:** `bab4dcd` - feat: improve document quality with strict rules

---

## 배포 상태

### Backend (Railway)
- 자동 배포 완료 (3개 커밋)
- Pre-deploy command 제거 완료 (이전 이슈 해결)

### Frontend (Vercel)
- 자동 배포 진행 중
- 사이드바 동기화 + 예상 시간 표시 반영 예정

---

## 테스트 필요 사항

1. **사이드바 동기화:**
   - 프로젝트 삭제 후 좌측 목록 즉시 업데이트 확인

2. **예상 시간 표시:**
   - 문서 생성 시작 후 "약 X분 남음" 표시 확인
   - 시간 경과에 따라 실시간 업데이트 확인

3. **이미지 품질:**
   - 새 문서 생성 시 관련 없는 이미지가 삽입되지 않는지 확인
   - 필요한 곳에만 적절한 이미지(차트/다이어그램) 표시 확인

4. **문서 가독성:**
   - 계층적 번호 매기기 (1. → 가. → 1) → a)) 적용 확인
   - 날짜/시간/금액 표기법 확인
   - 전반적인 가독성 개선 확인

---

## Git 커밋 이력

```
bab4dcd - feat: improve document quality with strict rules
3acecd6 - feat: add estimated completion time display
4b9218c - fix: sync sidebar project list on delete
fdfe135 - feat: add bulk delete functionality with multi-select
ff4ed91 - fix: manually delete related records before project deletion
33d31f5 - feat: add database migration script for CASCADE delete
0edf4d0 - fix: add CASCADE delete for project foreign keys
2591d75 - feat: add project delete functionality
```

---

## 학습 내용

### 1. Event-driven UI 업데이트
- Custom events (`window.dispatchEvent`)로 컴포넌트 간 통신
- Sidebar 같은 글로벌 컴포넌트를 효율적으로 업데이트
- 페이지 새로고침 없이 실시간 동기화

### 2. UX: 예상 시간 표시의 중요성
- 사용자는 "얼마나 기다려야 하는지" 알고 싶어함
- 진행률만으로는 부족 (0%에서 멈춘 것처럼 보일 수 있음)
- "약 15분 남음" 같은 구체적 시간이 불안감 감소

### 3. AI Prompt Engineering: 엄격한 규칙
- "관련 없는 이미지 추가 금지"를 명시적으로 지시
- ✓/✗ 예시로 명확한 기준 제시
- "의심스러우면 하지 마라" 원칙

### 4. 공문서 작성 규칙의 체계성
- 한국 공공기관의 문서 작성 규칙은 매우 구체적
- 날짜/시간/금액 표기법까지 세밀하게 정의
- 계층적 번호 체계로 가독성 향상
- 이러한 규칙을 AI 프롬프트에 포함하면 문서 품질 대폭 향상

---

## 다음 작업 예정

**형님 지시 대기 중**

가능한 작업:
- 문서 생성 테스트 (0% 멈춤 문제 해결 확인)
- 추가 기능 개발
- 문서 품질 검증

---

작업 완료 시각: 2026-02-11 11:23 GMT+9
작성자: 바질 (Basil) 🤖
